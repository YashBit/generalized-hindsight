No personal conf_private.py found.
doodad not detected
2022-03-26 23:46:58.657592 EDT | Variant:
2022-03-26 23:46:58.657819 EDT | {
  "seed": 1,
  "algorithm": "DIAYN",
  "env_name": "AntEnv",
  "algo_kwargs": {
    "batch_size": 256,
    "num_epochs": 100,
    "num_eval_steps_per_epoch": 25000,
    "num_expl_steps_per_train_loop": "None",
    "num_trains_per_train_loop": 100,
    "min_num_steps_before_training": 1000,
    "max_path_length": 1000,
    "num_train_loops_per_epoch": 1
  },
  "trainer_kwargs": {
    "discount": "None",
    "soft_target_tau": 0.005,
    "target_update_period": 1,
    "policy_lr": "None",
    "qf_lr": "None",
    "reward_scale": 1,
    "use_automatic_entropy_tuning": true
  },
  "replay_buffer_kwargs": {
    "max_replay_buffer_size": "None",
    "latent_dim": 1,
    "approx_irl": true,
    "plot": true
  },
  "relabeler_kwargs": {
    "relabel": true,
    "use_adv": true,
    "n_sampled_latents": 5,
    "n_to_take": 1,
    "cache": true
  },
  "qf_kwargs": {
    "hidden_sizes": [
      256,
      256
    ],
    "latent_shape_multiplier": 1,
    "latent_to_all_layers": true
  },
  "policy_kwargs": {
    "hidden_sizes": [
      256,
      256
    ],
    "latent_shape_multiplier": 1,
    "latent_to_all_layers": true
  },
  "path_collector_kwargs": {
    "save_videos": true
  },
  "use_advantages": true,
  "proper_advantages": true,
  "plot": true,
  "test": true,
  "gpu": 0,
  "mode": "here_no_doodad",
  "local_docker": false,
  "insert_time": true,
  "latent_shape_multiplier": 1,
  "env_kwargs": {
    "use_xy": true,
    "contact_forces": true
  },
  "gpu_id": 0
}
/ext3/pytorch_sac/lib/python3.6/site-packages/gym/spaces/box.py:74: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  "Box bound precision lowered by casting to {}".format(self.dtype)
workspace: /home/yb1025/Research/GRAIL/relabeler-irl/accelerate-skillDiscovery/generalized-hindsight/exp/2022.03.26/2346_diayn_gher_test_exp
The agent recognised is: {'name': 'diayn_gher', 'class': 'agent.diayn_gher.DIAYNGHERAgent', 'params': {'obs_dim': '???', 'action_dim': '???', 'action_range': '???', 'skill_dim': 4, 'obs_dim_weights': [1, 1], 'skill_type': 'discrete', 'device': '${device}', 'critic_cfg': '${double_q_critic}', 'actor_cfg': '${diag_gaussian_actor}', 'discriminator_cfg': '${discriminator}', 'discount': 0.99, 'init_temperature': 0.1, 'alpha_lr': 0.0001, 'alpha_betas': [0.9, 0.999], 'actor_lr': 0.0001, 'actor_betas': [0.9, 0.999], 'actor_update_frequency': 1, 'critic_lr': 0.0001, 'critic_betas': [0.9, 0.999], 'critic_tau': 0.005, 'critic_target_update_frequency': 2, 'discriminator_lr': 0.0001, 'discriminator_betas': [0.9, 0.999], 'discriminator_update_frequency': 1, 'batch_size': 1024, 'learnable_temperature': True, 'log_frequency': 10000, 'log_save_tb': True, 'name_env': 'AntEnv', 'max_replay_buffer_size': 1000000.0, 'plotter': 'None', 'render_eval_paths': False, 'use_automatic_entropy_tuning': True}}
AntEnv
Type of latent dim: <class 'int'>
1
Type of max replay : <class 'int'>
1000000
Traceback (most recent call last):
  File "launch_diayn.py", line 632, in <module>
    main()
  File "/ext3/pytorch_sac/lib/python3.6/site-packages/hydra/main.py", line 24, in decorated_main
    strict=strict,
  File "/ext3/pytorch_sac/lib/python3.6/site-packages/hydra/_internal/utils.py", line 174, in run_hydra
    overrides=args.overrides,
  File "/ext3/pytorch_sac/lib/python3.6/site-packages/hydra/_internal/hydra.py", line 86, in run
    job_subdir_key=None,
  File "/ext3/pytorch_sac/lib/python3.6/site-packages/hydra/plugins/common/utils.py", line 109, in run_job
    ret.return_value = task_function(task_cfg)
  File "launch_diayn.py", line 629, in main
    workspace.experiment()
  File "launch_diayn.py", line 408, in experiment
    **self.variant['algo_kwargs']
TypeError: __init__() got an unexpected keyword argument 'cfg'
